@page "/contact"
@using MiniBay.Shared.Features.Contact
@inject HttpClient Http
@using System.Net.Http.Json

<!-- Banner Superior -->
<section class="banner banner-contact">
    <div class="content-banner">
        <p>Contáctanos</p>
        <h2>Estamos Aquí <br /> Para Ayudarte</h2>
    </div>
</section>

<!-- Contenido Principal -->
<main class="main-content">
    <section class="container contact-layout">
        
        <!-- Columna Izquierda: Información de Contacto -->
        <div class="contact-details">
            @if (contactInfo == null)
            {
                <p><em>Cargando información de contacto...</em></p>
            }
            else
            {
                <h2>Información de Contacto</h2>
                <p>No dudes en escribirnos o llamarnos. Estamos listos para resolver tus dudas.</p>
                
                <ul class="contact-list">
                    <li>
                        <i class="fa-solid fa-location-dot"></i>
                        <div>
                            <strong>Oficinas</strong>
                            <span>@contactInfo.Address</span>
                        </div>
                    </li>
                    <li>
                        <i class="fa-solid fa-envelope"></i>
                        <div>
                            <strong>Email de Soporte</strong>
                            <a href="mailto:@contactInfo.SupportEmail">@contactInfo.SupportEmail</a>
                        </div>
                    </li>
                    <li>
                        <i class="fa-solid fa-phone"></i>
                        <div>
                            <strong>Atención al Cliente</strong>
                            <a href="tel:@contactInfo.CustomerServicePhone">@contactInfo.CustomerServicePhone</a>
                        </div>
                    </li>
                </ul>

                <h3 class="hours-title">Horario de Atención</h3>
                <ul class="hours-list">
                    @foreach (var hourInfo in contactInfo.Hours)
                    {
                        <li>@((MarkupString)hourInfo)</li>
                    }
                </ul>
            }
        </div>

        <!-- Columna Derecha: Formulario de Contacto (sin cambios) -->
        <div class="contact-form-container">
            <h2>Envíanos un Mensaje</h2>
            <p>Completa el formulario y nuestro equipo te responderá a la brevedad.</p>
            <form class="contact-form">
                <div class="form-group">
                    <label for="name">Nombre Completo</label>
                    <input type="text" id="name" name="name" placeholder="Tu nombre" required />
                </div>
                <div class="form-group">
                    <label for="email">Correo Electrónico</label>
                    <input type="email" id="email" name="email" placeholder="tu@email.com" required />
                </div>
                <div class="form-group">
                    <label for="subject">Asunto</label>
                    <input type="text" id="subject" name="subject" placeholder="Ej: Problema con una compra" required />
                </div>
                <div class="form-group">
                    <label for="message">Mensaje</label>
                    <textarea id="message" name="message" rows="6" placeholder="Escribe tu consulta aquí..." required></textarea>
                </div>
                <button type="submit" class="btn-submit">Enviar Mensaje</button>
            </form>
        </div>

    </section>
</main>

@code {
    private ContactInfoDto? contactInfo;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            // La URL debe coincidir con la ruta de tu API.
            // Asegúrate de que HttpClient tenga la URL base de tu API configurada en Program.cs.
            contactInfo = await Http.GetFromJsonAsync<ContactInfoDto>("api/contact");
        }
        catch (Exception ex)
        {
            // Opcional: Manejar errores, por ejemplo, si la API no está disponible.
            Console.WriteLine($"Error al cargar la información de contacto: {ex.Message}");
        }
    }
}